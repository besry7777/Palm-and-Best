<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>บาคาร่า Real-Time</title>
    <style>
        /* Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
            overflow: hidden;
            font-family: 'Noto Sans Thai', sans-serif;
        }
        
        body {
            background: #000;
            color: #fff;
            width: 100vw;
            height: 100vh;
            position: fixed;
            touch-action: manipulation;
        }
        
        /* Game Container */
        .game-container {
            width: 100%;
            height: 100%;
            position: relative;
            background: url('https://images.unsplash.com/photo-1518895949257-7621c3c786d7?ixlib=rb-1.2.1&auto=format&fit=crop&w=1480&q=80') no-repeat center center;
            background-size: cover;
        }
        
        .table-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
        }
        
        /* Header */
        .header {
            height: 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 1px solid #ff3366;
        }
        
        .logo {
            font-size: 20px;
            font-weight: bold;
            color: #ff3366;
            text-shadow: 0 0 5px rgba(255, 51, 102, 0.7);
        }
        
        .balance {
            font-size: 16px;
            color: #fff;
            background: rgba(255, 51, 102, 0.3);
            padding: 5px 12px;
            border-radius: 15px;
            border: 1px solid #ff3366;
        }
        
        /* Timer */
        .timer-container {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            z-index: 10;
        }
        
        .timer-bar {
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, #ff3366, #ff9933);
            transition: width 1s linear;
        }
        
        .timer-text {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* Game Area */
        .game-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 10px;
        }
        
        .cards-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
        }
        
        .cards-row {
            display: flex;
            justify-content: center;
            margin: 5px 0;
            position: relative;
        }
        
        /* Cards */
        .card {
            width: 70px;
            height: 95px;
            background: #fff;
            border-radius: 5px;
            margin: 0 3px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 26px;
            color: #000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            position: relative;
            transition: transform 0.3s;
        }
        
        .card.red {
            color: #ff0000;
        }
        
        .card-back {
            background: linear-gradient(135deg, #ff3366, #cc0066);
            color: white;
        }
        
        .card-value {
            position: absolute;
            font-size: 12px;
        }
        
        .top-left {
            top: 3px;
            left: 3px;
        }
        
        .bottom-right {
            bottom: 3px;
            right: 3px;
            transform: rotate(180deg);
        }
        
        /* Betting Area */
        .betting-area {
            height: 120px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 5px;
            background: rgba(0, 0, 0, 0.9);
            border-top: 1px solid #ff3366;
        }
        
        .bet-option {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
        }
        
        .bet-option:active {
            transform: scale(0.95);
        }
        
        .banker {
            background: linear-gradient(135deg, #ff3366, #cc0066);
            border: 1px solid #ff3366;
        }
        
        .player {
            background: linear-gradient(135deg, #3399ff, #0066cc);
            border: 1px solid #3399ff;
        }
        
        .tie {
            background: linear-gradient(135deg, #33cc33, #009933);
            border: 1px solid #33cc33;
        }
        
        .bet-amount {
            position: absolute;
            bottom: -15px;
            font-size: 12px;
            color: #fff;
            white-space: nowrap;
        }
        
        .chip {
            position: absolute;
            width: 25px;
            height: 25px;
            background: #ffcc00;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #000;
            top: -5px;
            right: -5px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
            font-size: 10px;
        }
        
        /* Bet Controls */
        .bet-controls {
            position: absolute;
            bottom: 130px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            display: flex;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            padding: 5px;
            border: 1px solid #ff3366;
        }
        
        .bet-button {
            width: 50px;
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #ff3366;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            color: #fff;
        }
        
        .bet-button:active {
            background: rgba(255, 51, 102, 0.5);
        }
        
        .current-bet {
            font-size: 14px;
            font-weight: bold;
            color: #ffcc00;
            display: flex;
            align-items: center;
        }
        
        /* Result */
        .result-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            font-weight: bold;
            color: #ffcc00;
            text-shadow: 0 0 8px rgba(0, 0, 0, 0.8);
            background: rgba(0, 0, 0, 0.7);
            padding: 8px 15px;
            border-radius: 15px;
            display: none;
        }
        
        /* History */
        .history {
            position: absolute;
            bottom: 170px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 3px;
            max-width: 90%;
            overflow-x: auto;
            padding: 5px;
        }
        
        .history-item {
            min-width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
        }
        
        .history-banker {
            background: #ff3366;
        }
        
        .history-player {
            background: #3399ff;
        }
        
        .history-tie {
            background: #33cc33;
        }
        
        /* Auto Play */
        .auto-play {
            position: absolute;
            top: 60px;
            right: 10px;
            background: rgba(255, 51, 102, 0.3);
            border: 1px solid #ff3366;
            color: #fff;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 3px;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="game-container">
        <div class="table-overlay">
            <div class="header">
                <div class="logo">BACCARAT</div>
                <div class="balance" id="balance">10,000</div>
            </div>
            
            <div class="timer-container">
                <div class="timer-bar" id="timer-bar"></div>
                <div class="timer-text" id="timer-text">วางเดิมพัน 15 วินาที</div>
            </div>
            
            <div class="auto-play">
                <i class="fas fa-play"></i> AUTO
            </div>
            
            <div class="game-area">
                <div class="cards-area">
                    <div class="history" id="history"></div>
                    
                    <div class="cards-row" id="banker-cards">
                        <!-- Banker cards will be here -->
                    </div>
                    
                    <div class="cards-row" id="player-cards">
                        <!-- Player cards will be here -->
                    </div>
                    
                    <div class="result-display" id="result"></div>
                </div>
                
                <div class="bet-controls">
                    <div class="bet-button" id="bet-100">+100</div>
                    <div class="bet-button" id="bet-500">+500</div>
                    <div class="current-bet" id="current-bet">100</div>
                    <div class="bet-button" id="bet-1000">+1000</div>
                    <div class="bet-button" id="bet-5000">+5000</div>
                </div>
                
                <div class="betting-area">
                    <div class="bet-option banker" id="bet-banker">
                        <div>BANKER</div>
                        <div class="bet-amount">1.95x</div>
                        <div class="chip" id="banker-chip" style="display: none;">100</div>
                    </div>
                    
                    <div class="bet-option tie" id="bet-tie">
                        <div>TIE</div>
                        <div class="bet-amount">8x</div>
                        <div class="chip" id="tie-chip" style="display: none;">100</div>
                    </div>
                    
                    <div class="bet-option player" id="bet-player">
                        <div>PLAYER</div>
                        <div class="bet-amount">2x</div>
                        <div class="chip" id="player-chip" style="display: none;">100</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game configuration
        const config = {
            initialBalance: 10000,
            initialBet: 100,
            bettingTime: 15, // seconds
            dealingTime: 10, // seconds
            autoPlayDelay: 2000
        };
        
        // Game state
        let state = {
            balance: config.initialBalance,
            currentBetType: null,
            currentBetAmount: config.initialBet,
            gameInProgress: false,
            bettingPhase: true,
            history: [],
            timer: null,
            timeLeft: config.bettingTime
        };
        
        // DOM elements
        const balanceElement = document.getElementById('balance');
        const resultElement = document.getElementById('result');
        const historyElement = document.getElementById('history');
        const bankerCardsElement = document.getElementById('banker-cards');
        const playerCardsElement = document.getElementById('player-cards');
        const timerBar = document.getElementById('timer-bar');
        const timerText = document.getElementById('timer-text');
        const currentBetElement = document.getElementById('current-bet');
        
        // Betting elements
        const betBanker = document.getElementById('bet-banker');
        const betPlayer = document.getElementById('bet-player');
        const betTie = document.getElementById('bet-tie');
        const bankerChip = document.getElementById('banker-chip');
        const playerChip = document.getElementById('player-chip');
        const tieChip = document.getElementById('tie-chip');
        
        // Bet amount controls
        const bet100 = document.getElementById('bet-100');
        const bet500 = document.getElementById('bet-500');
        const bet1000 = document.getElementById('bet-1000');
        const bet5000 = document.getElementById('bet-5000');
        
        // Card data
        const cardValues = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const cardSuits = ['♥', '♦', '♣', '♠'];
        
        // Initialize game
        initGame();
        
        // Event listeners
        betBanker.addEventListener('click', () => placeBet('banker'));
        betPlayer.addEventListener('click', () => placeBet('player'));
        betTie.addEventListener('click', () => placeBet('tie'));
        
        bet100.addEventListener('click', () => adjustBet(100));
        bet500.addEventListener('click', () => adjustBet(500));
        bet1000.addEventListener('click', () => adjustBet(1000));
        bet5000.addEventListener('click', () => adjustBet(5000));
        
        // Game functions
        function initGame() {
            updateBalance();
            updateCurrentBetDisplay();
            startBettingTimer();
        }
        
        function startBettingTimer() {
            state.bettingPhase = true;
            state.timeLeft = config.bettingTime;
            updateTimerDisplay();
            
            clearInterval(state.timer);
            state.timer = setInterval(() => {
                state.timeLeft--;
                updateTimerDisplay();
                
                if (state.timeLeft <= 0) {
                    clearInterval(state.timer);
                    endBettingPhase();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const percentage = (state.timeLeft / config.bettingTime) * 100;
            timerBar.style.width = `${percentage}%`;
            
            if (state.bettingPhase) {
                timerText.textContent = `วางเดิมพัน ${state.timeLeft} วินาที`;
                
                // Change color when time is running out
                if (state.timeLeft <= 5) {
                    timerBar.style.background = 'linear-gradient(90deg, #ff0000, #ff6600)';
                } else {
                    timerBar.style.background = 'linear-gradient(90deg, #ff3366, #ff9933)';
                }
            } else {
                timerText.textContent = `กำลังแจกไพ่ ${state.timeLeft} วินาที`;
                timerBar.style.background = 'linear-gradient(90deg, #3399ff, #33ccff)';
            }
        }
        
        function endBettingPhase() {
            state.bettingPhase = false;
            state.timeLeft = config.dealingTime;
            
            // Auto place bet if none was placed
            if (!state.currentBetType && state.balance >= state.currentBetAmount) {
                const randomBet = ['banker', 'player', 'tie'][Math.floor(Math.random() * 3)];
                placeBet(randomBet);
            }
            
            // Start dealing phase
            state.timer = setInterval(() => {
                state.timeLeft--;
                updateTimerDisplay();
                
                if (state.timeLeft <= 0) {
                    clearInterval(state.timer);
                    startGame();
                }
            }, 1000);
        }
        
        function placeBet(type) {
            if (!state.bettingPhase || state.gameInProgress || state.balance < state.currentBetAmount) return;
            
            // Reset current bet
            resetBetsUI();
            
            // Place new bet
            state.currentBetType = type;
            state.balance -= state.currentBetAmount;
            
            // Update UI
            updateBalance();
            showBetChip(type);
        }
        
        function adjustBet(amount) {
            if (!state.bettingPhase) return;
            
            state.currentBetAmount += amount;
            
            // Ensure bet amount doesn't exceed balance
            if (state.currentBetAmount > state.balance) {
                state.currentBetAmount = state.balance;
            }
            
            // Minimum bet
            if (state.currentBetAmount < 100) {
                state.currentBetAmount = 100;
            }
            
            updateCurrentBetDisplay();
        }
        
        function startGame() {
            if (state.gameInProgress) return;
            
            state.gameInProgress = true;
            
            // Clear previous cards
            bankerCardsElement.innerHTML = '';
            playerCardsElement.innerHTML = '';
            
            // Generate and shuffle deck
            let deck = generateDeck();
            deck = shuffleDeck(deck);
            
            // Deal initial cards
            const bankerCards = [deck.pop(), deck.pop()];
            const playerCards = [deck.pop(), deck.pop()];
            
            // Display cards with animation
            dealCards(bankerCards, playerCards, () => {
                // Calculate initial scores
                const bankerScore = calculateScore(bankerCards);
                const playerScore = calculateScore(playerCards);
                
                // Check for natural win
                if (bankerScore >= 8 || playerScore >= 8) {
                    finishGame(bankerCards, playerCards, bankerScore, playerScore);
                    return;
                }
                
                // Player drawing rules
                let playerDrewThirdCard = false;
                if (playerScore <= 5) {
                    playerCards.push(deck.pop());
                    playerDrewThirdCard = true;
                    
                    setTimeout(() => {
                        dealThirdCard(playerCards[2], 'player', () => {
                            // Banker drawing rules
                            const shouldBankerDraw = shouldBankerDrawThirdCard(
                                bankerScore, 
                                playerScore, 
                                playerCards[2]?.value
                            );
                            
                            if (shouldBankerDraw) {
                                bankerCards.push(deck.pop());
                                
                                setTimeout(() => {
                                    dealThirdCard(bankerCards[2], 'banker', () => {
                                        finishGame(
                                            bankerCards, 
                                            playerCards, 
                                            calculateScore(bankerCards), 
                                            calculateScore(playerCards)
                                        );
                                    });
                                }, 500);
                            } else {
                                finishGame(bankerCards, playerCards, bankerScore, calculateScore(playerCards));
                            }
                        });
                    }, 500);
                } else {
                    // Banker drawing rules when player stands
                    if (bankerScore <= 5) {
                        bankerCards.push(deck.pop());
                        
                        setTimeout(() => {
                            dealThirdCard(bankerCards[2], 'banker', () => {
                                finishGame(
                                    bankerCards, 
                                    playerCards, 
                                    calculateScore(bankerCards), 
                                    playerScore
                                );
                            });
                        }, 500);
                    } else {
                        finishGame(bankerCards, playerCards, bankerScore, playerScore);
                    }
                }
            });
        }
        
        function dealCards(bankerCards, playerCards, callback) {
            // Deal first card to player and banker
            setTimeout(() => {
                createCardElement(playerCards[0], 'player');
                createCardElement(bankerCards[0], 'banker');
                
                // Deal second card (face down)
                setTimeout(() => {
                    const playerCard = createCardElement(null, 'player', true);
                    const bankerCard = createCardElement(null, 'banker', true);
                    
                    // Reveal cards after a delay
                    setTimeout(() => {
                        playerCard.innerHTML = '';
                        bankerCard.innerHTML = '';
                        createCardFace(playerCards[1], playerCard);
                        createCardFace(bankerCards[1], bankerCard);
                        
                        if (callback) callback();
                    }, 500);
                }, 500);
            }, 500);
        }
        
        function dealThirdCard(card, type, callback) {
            createCardElement(card, type);
            if (callback) setTimeout(callback, 500);
        }
        
        function createCardElement(card, type, isFaceDown = false) {
            const cardElement = document.createElement('div');
            cardElement.className = 'card';
            
            if (isFaceDown) {
                cardElement.classList.add('card-back');
            } else if (card) {
                createCardFace(card, cardElement);
            }
            
            const parentElement = type === 'banker' ? bankerCardsElement : playerCardsElement;
            parentElement.appendChild(cardElement);
            
            return cardElement;
        }
        
        function createCardFace(card, element) {
            if (card.suit === '♥' || card.suit === '♦') {
                element.classList.add('red');
            }
            
            element.innerHTML = `
                <div class="card-value top-left">${card.value}</div>
                <div style="font-size: 26px;">${card.suit}</div>
                <div class="card-value bottom-right">${card.value}</div>
            `;
        }
        
        function calculateScore(cards) {
            let score = 0;
            
            for (const card of cards) {
                if (!card) continue;
                
                if (['10', 'J', 'Q', 'K'].includes(card.value)) {
                    score += 0;
                } else if (card.value === 'A') {
                    score += 1;
                } else {
                    score += parseInt(card.value);
                }
            }
            
            return score % 10;
        }
        
        function shouldBankerDrawThirdCard(bankerScore, playerScore, playerThirdCardValue) {
            if (!playerThirdCardValue) {
                return bankerScore <= 5;
            }
            
            const playerThirdCardNumeric = ['10', 'J', 'Q', 'K'].includes(playerThirdCardValue) ? 0 : 
                                         playerThirdCardValue === 'A' ? 1 : parseInt(playerThirdCardValue);
            
            if (bankerScore <= 2) return true;
            if (bankerScore === 3) return playerThirdCardNumeric !== 8;
            if (bankerScore === 4) return playerThirdCardNumeric >= 2 && playerThirdCardNumeric <= 7;
            if (bankerScore === 5) return playerThirdCardNumeric >= 4 && playerThirdCardNumeric <= 7;
            if (bankerScore === 6) return playerThirdCardNumeric >= 6 && playerThirdCardNumeric <= 7;
            return false;
        }
        
        function finishGame(bankerCards, playerCards, bankerScore, playerScore) {
            // Determine winner
            let winner;
            let payoutMultiplier = 0;
            
            if (bankerScore > playerScore) {
                winner = 'banker';
                payoutMultiplier = 1.95;
                showResult(`BANKER ${bankerScore}-${playerScore}`);
            } else if (playerScore > bankerScore) {
                winner = 'player';
                payoutMultiplier = 2;
                showResult(`PLAYER ${playerScore}-${bankerScore}`);
            } else {
                winner = 'tie';
                payoutMultiplier = 8;
                showResult(`TIE ${playerScore}-${playerScore}`);
            }
            
            // Update history
            state.history.push(winner);
            updateHistory();
            
            // Calculate winnings
            if (state.currentBetType === winner) {
                const winnings = Math.floor(state.currentBetAmount * payoutMultiplier);
                state.balance += winnings;
                showResult(`${winner.toUpperCase()} WIN +${winnings}`);
            }
            
            // Reset for next round
            resetRound();
            
            // Start next round after delay
            setTimeout(() => {
                startBettingTimer();
            }, 2000);
        }
        
        function resetRound() {
            state.currentBetType = null;
            state.gameInProgress = false;
            updateBalance();
            resetBetsUI();
        }
        
        function showResult(message) {
            resultElement.textContent = message;
            resultElement.style.display = 'block';
            
            setTimeout(() => {
                resultElement.style.display = 'none';
            }, 2000);
        }
        
        function updateBalance() {
            balanceElement.textContent = state.balance.toLocaleString();
        }
        
        function updateCurrentBetDisplay() {
            currentBetElement.textContent = state.currentBetAmount.toLocaleString();
        }
        
        function updateHistory() {
            historyElement.innerHTML = '';
            
            const recentHistory = state.history.slice(-12);
            for (const result of recentHistory) {
                const item = document.createElement('div');
                item.className = `history-item history-${result}`;
                item.textContent = result === 'banker' ? 'B' : result === 'player' ? 'P' : 'T';
                historyElement.appendChild(item);
            }
        }
        
        function resetBetsUI() {
            bankerChip.style.display = 'none';
            playerChip.style.display = 'none';
            tieChip.style.display = 'none';
        }
        
        function showBetChip(type) {
            if (type === 'banker') {
                bankerChip.style.display = 'flex';
                bankerChip.textContent = state.currentBetAmount;
            } else if (type === 'player') {
                playerChip.style.display = 'flex';
                playerChip.textContent = state.currentBetAmount;
            } else {
                tieChip.style.display = 'flex';
                tieChip.textContent = state.currentBetAmount;
            }
        }
        
        function generateDeck() {
            const deck = [];
            for (const suit of cardSuits) {
                for (const value of cardValues) {
                    deck.push({ suit, value });
                }
            }
            return deck;
        }
        
        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }
    </script>
</body>
</html>